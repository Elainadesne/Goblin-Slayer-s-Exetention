# 清除浏览器缓存说明

## 问题

如果你点击"重新加载"按钮后仍然刷新了整个浏览器，可能是浏览器缓存了旧版本的代码。

## 解决方案

### 方法 1：硬刷新（推荐）

**Windows/Linux:**
- `Ctrl + Shift + R` 或 `Ctrl + F5`

**Mac:**
- `Cmd + Shift + R`

### 方法 2：清除缓存

#### Chrome/Edge

1. 按 `F12` 打开开发者工具
2. 右键点击刷新按钮
3. 选择"清空缓存并硬性重新加载"

或者：

1. 按 `Ctrl + Shift + Delete` (Mac: `Cmd + Shift + Delete`)
2. 选择"缓存的图片和文件"
3. 时间范围选择"全部时间"
4. 点击"清除数据"

#### Firefox

1. 按 `Ctrl + Shift + Delete` (Mac: `Cmd + Shift + Delete`)
2. 选择"缓存"
3. 时间范围选择"全部"
4. 点击"立即清除"

### 方法 3：禁用缓存（开发模式）

1. 按 `F12` 打开开发者工具
2. 打开设置（齿轮图标或 `F1`）
3. 找到"Network"部分
4. 勾选"Disable cache (while DevTools is open)"
5. 保持开发者工具打开状态

## 验证新版本已加载

打开浏览器控制台（F12），查找以下日志：

```
[GS StatusBar] [INFO] GS状态栏扩展开始加载
[GS StatusBar] [INFO] script.js 版本: 2.0 (支持扩展级重新加载)
```

如果看到 "版本: 2.0"，说明新版本已加载。

## 测试重新加载功能

1. 打开浏览器控制台（F12）
2. 运行测试脚本：
   ```javascript
   // 复制 test_reload.js 的内容到控制台
   ```

3. 或者直接检查：
   ```javascript
   // 检查版本
   window.gsStatusBarEarlyLogs?.find(log => log.message.includes('版本'))
   
   // 检查 reinitialize 方法
   typeof window.gsStatusBarApp?.reinitialize
   ```

## 新版本的改进

### 错误面板

- ✅ 显示详细的错误信息和日志
- ✅ "重新加载"按钮 - 重新初始化扩展（不刷新浏览器）
- ✅ "复制日志"按钮 - 复制所有日志
- ✅ "关闭"按钮 - 关闭错误面板

### 应用错误界面

- ✅ "重新加载扩展"按钮 - 调用 app.reinitialize()
- ✅ "刷新页面"按钮 - 刷新整个浏览器（备用方案）

### 右键菜单

- ✅ "重新加载数据" - 重新获取数据并刷新界面
- ✅ "查看日志" - 打开日志标签页
- ✅ "切换控制台输出" - 启用/禁用控制台日志

## 常见问题

### Q: 为什么还是刷新了浏览器？

A: 可能的原因：
1. 浏览器缓存了旧版本代码 → 清除缓存
2. 点击了"刷新页面"按钮而不是"重新加载扩展" → 注意按钮区别
3. 代码未正确更新 → 检查文件修改时间

### Q: 如何确认是哪个版本？

A: 在控制台运行：
```javascript
window.gsStatusBarEarlyLogs?.find(log => log.message.includes('版本'))
```

应该看到：
```javascript
{
  timestamp: "...",
  level: "INFO",
  message: "script.js 版本: 2.0 (支持扩展级重新加载)"
}
```

### Q: 重新加载扩展和刷新页面有什么区别？

A: 
- **重新加载扩展**：只重新初始化扩展，速度快，不影响其他内容
- **刷新页面**：重新加载整个页面，速度慢，所有扩展都会重新加载

### Q: 什么时候应该刷新页面？

A: 
- 重新加载扩展多次失败
- 浏览器出现其他问题
- 需要更新其他扩展
- 酒馆本身需要刷新

## 开发者提示

如果你在开发或调试扩展：

1. **始终禁用缓存**
   - 打开开发者工具
   - 勾选"Disable cache"

2. **使用硬刷新**
   - `Ctrl + Shift + R` (Windows/Linux)
   - `Cmd + Shift + R` (Mac)

3. **检查文件修改时间**
   ```bash
   ls -la gs_status_bar_extension/script.js
   ls -la gs_status_bar_extension/app.js
   ```

4. **查看网络请求**
   - 开发者工具 → Network 标签
   - 查找 script.js 和 app.js
   - 检查是否从缓存加载（from cache）
